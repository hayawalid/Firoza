<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/CSS/nav-bar-white.css">
    <link rel="stylesheet" href="/CSS/Footer.css">
    <link rel="stylesheet" href="/CSS/navBar.css">
    <link rel="stylesheet" href="/CSS/productCardDetails.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <title>Product Details</title>
</head>
<body>
    <%- include('./partials/Nav-Bar.ejs') %>
    <div class="whole-prod-page">
        <div class="upper-half-prod">
            <div class="prod-pic">
                <img src="/images/Indian/Newfolder/<%= product.img %>" alt="Product Image">
            </div>
            <div class="price-rating">
                <h2><%= product.name %></h2>
                <br>
                <p>EGP <%= product.price %></p>
                <br><br>
                <div class="rate-stat" id="rate-stat">
                    <% for (let i = 0; i < Math.floor(averageRating); i++) { %>
                        <span class="star filled">&#9733;</span>
                    <% } %>
                    <% if (averageRating % 1 >= 0.5) { %>
                        <span class="star">&#9733;</span>
                    <% } %>
                    <% for (let i = Math.ceil(averageRating); i <= 5; i++) { %>
                        <span class="star">&#9733;</span>
                    <% } %>
                    <a href="#reviews" class="stat" id="average-rating">(Average Rating: <%= averageRating.toFixed(1) %>)</a>
                    <a href="#reviews" class="stat" id="review-count">(<%= reviewCount %> review<%= reviewCount !== 1 ? 's' : '' %>)</a>
                </div>
                <div class="button-container">
                    <span class="button add-to-bag" onclick="addToCart('<%= product._id %>')"><i class="fas fa-shopping-bag"></i>Add to bag</span>
                    <span class="button add-to-wishlist" onclick="addToWishlist('<%= product._id %>')"><i class="fas fa-heart"></i>Add to wishlist</span>
                </div>
                <div class="prod-details">
                    <hr class="details-divider">
                    <span class="description-part" onclick="toggleDetails('description-content')">
                        Product Description <i class="fas fa-plus"></i>
                    </span>
                    <div id="description-content" class="details-content">
                        <p><%= product.description %></p>
                    </div>
                </div>
                <div class="prod-details">
                    <hr class="details-divider">
                    <span class="description-part" onclick="toggleDetails('shipping-returns-content')">
                        Shipping and Returns <i class="fas fa-plus"></i>
                    </span>
                    <div id="shipping-returns-content" class="details-content">
                        <p>Details about shipping and returns...</p>
                    </div>
                </div>
                <div class="prod-details">
                    <hr class="details-divider">
                    <span class="description-part" onclick="toggleDetails('similar-products-content')">
                        Similar Products <i class="fas fa-plus"></i>
                    </span>
                    <div id="similar-products-content" class="details-content">
                        <p>Details about similar products...</p>
                    </div>
                </div>
            </div>
            </div>
        </div>
        <div class="lower-half-prod">
            <h3>Reviews</h3>
            <hr class="details-divider">
            <div id="reviews">
                <% reviews.forEach(review => { %>
                    <div class="review-box">
                        <div class="review-left">
                            <div class="review-header">
                                <div class="review-avatar">
                                    <i class="fa-regular fa-circle-user"></i>
                                </div>
                                <div class="review-info">
                                    <p class="reviewer-name"><%= review.user.firstname %> <%= review.user.lastname %></p>
                                    <p class="review-date"><%= new Date(review.created_at).toLocaleDateString() %></p>
                                </div>
                            </div>
                            <div class="review-content">
                                <div class="review-rating">
                                    <% for (let i = 0; i < review.rating; i++) { %>
                                        <span class="star filled">&#9733;</span>
                                    <% } %>
                                    <% for (let i = review.rating; i < 5; i++) { %>
                                        <span class="star">&#9733;</span>
                                    <% } %>
                                </div>
                                <p class="review-text"><%= review.comment %></p>
                            </div>
                        </div>
                    </div>
                    <hr class="details-divider">
                <% }) %>
        </div>
        </div>
    </div>

   

    
    <!-- <script>
        // Populate product details from session storage
        const productDetails = JSON.parse(sessionStorage.getItem('productDetails'));
        if (productDetails) {
            document.getElementById('productImage').src = `/images/Indian/Newfolder/${productDetails.img}`;
            document.getElementById('productName').textContent = productDetails.name;
            document.getElementById('productPrice').textContent = productDetails.price;
            document.getElementById('productDescription').innerHTML = productDetails.description;
            // You can add more details as needed
        }
    </script> -->

    <script src="/Javascript/productCardDetails.js"></script>
    <script src="/Javascript/openproduct.js"></script>
</body>
</html>
